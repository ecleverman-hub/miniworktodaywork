<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlowUp | ä¸ªäººæˆé•¿çœ‹æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #8E94F2;
            --secondary: #BBADFF;
            --success: #6ECB63;
            --danger: #FF8080;
            --bg: #F8F9FD;
            --sidebar-bg: rgba(255, 255, 255, 0.8);
            --text-main: #2D3250;
            --text-sub: #707793;
        }

        * { box-sizing: border-box; font-family: "PingFang SC", "Microsoft YaHei", sans-serif; }
        body { margin: 0; background: var(--bg); color: var(--text-main); height: 100vh; display: flex; overflow: hidden; }

        /* --- ä¾§è¾¹å¯¼èˆª --- */
        .sidebar {
            width: 220px; background: var(--sidebar-bg); backdrop-filter: blur(20px);
            border-right: 1px solid rgba(0,0,0,0.05); display: flex; flex-direction: column; padding: 30px 15px;
        }
        .logo { font-size: 22px; font-weight: 900; color: var(--primary); margin-bottom: 40px; }
        .nav-item {
            padding: 14px 18px; border-radius: 16px; cursor: pointer; margin-bottom: 8px;
            transition: 0.3s; display: flex; align-items: center; gap: 12px; color: var(--text-sub);
        }
        .nav-item:hover { background: rgba(142, 148, 242, 0.1); color: var(--primary); }
        .nav-item.active { background: var(--primary); color: white; box-shadow: 0 4px 15px rgba(142,148,242,0.3); }

        /* --- ä¸»å†…å®¹åŒº --- */
        .main { flex: 1; overflow-y: auto; padding: 40px; position: relative; }
        .view-section { display: none; animation: slideUp 0.4s ease; }
        .view-section.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- åŠŸèƒ½ç»„ä»¶ --- */
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .glass-card { background: #fff; border-radius: 24px; padding: 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.03); border: 1px solid #fff; }

        /* ä»»åŠ¡åˆ—è¡¨æ ·å¼ */
        .task-row { display: flex; align-items: center; gap: 12px; padding: 12px 0; border-bottom: 1px f0f0f0 solid; }
        .check-circle { width: 22px; height: 22px; border: 2px solid var(--secondary); border-radius: 50%; cursor: pointer; transition: 0.2s; }
        .task-row.done { opacity: 0.5; text-decoration: line-through; }
        .task-row.done .check-circle { background: var(--success); border-color: var(--success); }

        /* ç¬”è®°/é”™é¢˜æœ¬æ ·å¼ */
        .retro-card { background: #fff; border-left: 5px solid var(--primary); margin-bottom: 15px; transition: 0.3s; }
        .retro-card:hover { transform: translateX(5px); }
        .tag { font-size: 11px; padding: 2px 8px; border-radius: 5px; background: var(--bg); color: var(--primary); margin-right: 5px; }

        /* è¾“å…¥åŒºåŸŸ */
        .input-group { display: flex; gap: 10px; margin-bottom: 30px; }
        input, textarea, select { padding: 12px 18px; border-radius: 14px; border: 1px solid #EEE; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--primary); }
        .btn-main { background: var(--primary); color: #fff; border: none; padding: 12px 25px; border-radius: 14px; cursor: pointer; font-weight: 600; }

        /* çƒ­åŠ›å›¾ */
        .heat-map { display: flex; gap: 4px; flex-wrap: wrap; margin-top: 10px; }
        .heat-cell { width: 14px; height: 14px; border-radius: 3px; background: #EBEDF0; }
        .heat-cell.active { background: var(--success); }
    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="logo">GlowUp âœ¨</div>
        <div class="nav-item active" onclick="switchView('todo', this)">ğŸ—“ï¸ æ¯æ—¥æ¸…å•</div>
        <div class="nav-item" onclick="switchView('retro', this)">ğŸ’¡ èŒåœºå¤ç›˜</div>
        <div class="nav-item" onclick="switchView('resource', this)">ğŸ”— èµ„æºå¯¼èˆª</div>
        <div class="nav-item" onclick="switchView('stats', this)">ğŸ“ˆ æˆé•¿çƒ­åŠ›</div>
        
        <div style="margin-top: auto; padding: 15px; background: #fff; border-radius: 18px; font-size: 13px;">
            <div style="color: var(--text-sub);">å·²è¿ç»­è“„èƒ½</div>
            <div style="font-size: 20px; font-weight: 800; color: var(--primary);"><span id="streakDays">0</span> å¤©</div>
        </div>
    </nav>

    <main class="main">
        <section id="view-todo" class="view-section active">
            <h2 id="todayText">ä»Šæ—¥æ¸…å•</h2>
            <div class="input-group">
                <input type="text" id="todoInput" placeholder="è¾“å…¥ä»»åŠ¡ï¼Œå›è½¦æ·»åŠ ..." style="flex:1">
                <button class="btn-main" onclick="addTodo()">æ·»åŠ </button>
            </div>
            <div id="todoList" class="glass-card"></div>
        </section>

        <section id="view-retro" class="view-section">
            <h2>ğŸ’¡ èŒåœºå¤ç›˜ / ç»éªŒæ²‰æ·€</h2>
            <div class="glass-card" style="margin-bottom:20px;">
                <div class="input-group" style="flex-direction: column;">
                    <input type="text" id="retroTitle" placeholder="é‡åˆ°çš„é—®é¢˜æˆ–æ–°å­¦åˆ°çš„ç‚¹">
                    <textarea id="retroContent" placeholder="ä¸‹æ¬¡æ€ä¹ˆåšæ‰èƒ½æ›´å¥½ï¼Ÿ(SOP)" style="height:80px;"></textarea>
                    <button class="btn-main" onclick="addRetro()">è®°å½•ç»éªŒ</button>
                </div>
            </div>
            <div id="retroList"></div>
        </section>

        <section id="view-resource" class="view-section">
            <h2>ğŸ”— å¸¸ç”¨èµ„æºé“¾æ¥</h2>
            <div class="input-group">
                <input type="text" id="resName" placeholder="èµ„æºåç§°" style="flex:1">
                <input type="text" id="resUrl" placeholder="URL åœ°å€" style="flex:2">
                <button class="btn-main" onclick="addResource()">æ”¶è—</button>
            </div>
            <div class="card-grid" id="resourceList"></div>
        </section>

        <section id="view-stats" class="view-section">
            <h2>ğŸ“ˆ æˆé•¿è¶³è¿¹</h2>
            <div class="glass-card">
                <p style="color:var(--text-sub)">è¿‡å» 100 å¤©çš„ä»»åŠ¡å®Œæˆçƒ­åº¦ï¼š</p>
                <div class="heat-map" id="heatMap"></div>
            </div>
        </section>
    </main>

<script>
    // --- çŠ¶æ€ç®¡ç† ---
    const getTodayKey = () => new Date().toISOString().split('T')[0];
    let state = {
        todos: JSON.parse(localStorage.getItem('glow_v7_todos')) || {},
        retros: JSON.parse(localStorage.getItem('glow_v7_retros')) || [],
        resources: JSON.parse(localStorage.getItem('glow_v7_resources')) || [
            {name: 'å…¬å¸æ–‡æ¡£', url: '#'}, {name: 'è®¾è®¡ç´ æ', url: 'https://dribbble.com'}
        ],
        streak: Number(localStorage.getItem('glow_v7_streak')) || 0,
        lastDate: localStorage.getItem('glow_v7_lastdate') || ''
    };

    // --- åˆå§‹åŒ– ---
    function init() {
        checkStreak();
        renderTodos();
        renderRetros();
        renderResources();
        renderHeatMap();
        document.getElementById('todayText').innerText = "ä»Šæ—¥è®¡åˆ’ - " + getTodayKey();
    }

    function switchView(viewId, el) {
        document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
        document.getElementById('view-' + viewId).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
    }

    // --- é€»è¾‘åŠŸèƒ½ ---
    function addTodo() {
        const input = document.getElementById('todoInput');
        if (!input.value) return;
        const key = getTodayKey();
        if (!state.todos[key]) state.todos[key] = [];
        state.todos[key].push({ text: input.value, done: false });
        input.value = '';
        saveAndRender();
    }

    function toggleTodo(idx) {
        state.todos[getTodayKey()][idx].done = !state.todos[getTodayKey()][idx].done;
        saveAndRender();
    }

    function addRetro() {
        const title = document.getElementById('retroTitle').value;
        const content = document.getElementById('retroContent').value;
        if (!title) return;
        state.retros.unshift({ title, content, date: getTodayKey() });
        document.getElementById('retroTitle').value = '';
        document.getElementById('retroContent').value = '';
        saveAndRender();
    }

    function addResource() {
        const name = document.getElementById('resName').value;
        const url = document.getElementById('resUrl').value;
        if (!name || !url) return;
        state.resources.push({ name, url: url.startsWith('http') ? url : 'https://' + url });
        document.getElementById('resName').value = '';
        document.getElementById('resUrl').value = '';
        saveAndRender();
    }

    // --- æ¸²æŸ“å¼•æ“ ---
    function renderTodos() {
        const list = document.getElementById('todoList');
        const tasks = state.todos[getTodayKey()] || [];
        list.innerHTML = tasks.length ? '' : '<p style="color:#CCC;text-align:center">ä»Šå¤©è¿˜æ²¡å®‰æ’ä»»åŠ¡ âœ¨</p>';
        tasks.forEach((t, i) => {
            const div = document.createElement('div');
            div.className = `task-row ${t.done ? 'done' : ''}`;
            div.innerHTML = `<div class="check-circle" onclick="toggleTodo(${i})"></div><span>${t.text}</span>`;
            list.appendChild(div);
        });
    }

    function renderRetros() {
        const list = document.getElementById('retroList');
        list.innerHTML = '';
        state.retros.forEach(r => {
            const div = document.createElement('div');
            div.className = 'glass-card retro-card';
            div.innerHTML = `
                <div style="font-size:12px; color:var(--primary); margin-bottom:5px;">${r.date}</div>
                <strong style="display:block; margin-bottom:8px;">${r.title}</strong>
                <div style="font-size:14px; color:var(--text-sub); white-space:pre-wrap;">${r.content}</div>
            `;
            list.appendChild(div);
        });
    }

    function renderResources() {
        const list = document.getElementById('resourceList');
        list.innerHTML = '';
        state.resources.forEach(r => {
            const a = document.createElement('a');
            a.href = r.url; a.target = "_blank";
            a.className = "glass-card";
            a.style.textDecoration = "none";
            a.innerHTML = `<div style="color:var(--primary); font-weight:700;">${r.name}</div><div style="font-size:12px;color:#AAA">${r.url.substring(0,30)}...</div>`;
            list.appendChild(a);
        });
    }

    function renderHeatMap() {
        const map = document.getElementById('heatMap');
        map.innerHTML = '';
        for (let i = 0; i < 100; i++) {
            const cell = document.createElement('div');
            cell.className = 'heat-cell';
            // ç®€å•æ¨¡æ‹Ÿè¿‡å»å‡ å¤©çš„å®Œæˆæƒ…å†µ
            const date = new Date(); date.setDate(date.getDate() - (99 - i));
            const key = date.toISOString().split('T')[0];
            if (state.todos[key] && state.todos[key].some(t => t.done)) cell.classList.add('active');
            map.appendChild(cell);
        }
    }

    function checkStreak() {
        const today = getTodayKey();
        if (state.lastDate === today) return;
        const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
        const yestKey = yesterday.toISOString().split('T')[0];
        
        if (state.lastDate === yestKey) {
            state.streak++;
        } else if (state.lastDate !== today) {
            state.streak = 0;
        }
        state.lastDate = today;
        document.getElementById('streakDays').innerText = state.streak;
        localStorage.setItem('glow_v7_streak', state.streak);
        localStorage.setItem('glow_v7_lastdate', state.lastDate);
    }

    function saveAndRender() {
        localStorage.setItem('glow_v7_todos', JSON.stringify(state.todos));
        localStorage.setItem('glow_v7_retros', JSON.stringify(state.retros));
        localStorage.setItem('glow_v7_resources', JSON.stringify(state.resources));
        renderTodos(); renderRetros(); renderResources(); renderHeatMap();
    }

    document.getElementById('todoInput').onkeydown = (e) => e.key === 'Enter' && addTodo();

    init();
</script>
</body>
</html>